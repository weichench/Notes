## Abstract

+ 闭环
+ 地图复用，以达到零偏移的定位
+ 先进的imu初始化

![1569332599480](/home/slam/.config/Typora/typora-user-images/1569332599480.png)

###  imu的预计分

+ 求bias对预积分的雅克比，一阶近似bias对预计分值的影响

### 预积分的雅克比及协方差的传递

### imu的初始化

+ 陀螺仪的偏置
+ 尺度与重力加速度预估
+ 加速度计偏置标定和尺度重力加速度优化
  + 只优化重力加速度方向
+ 将首帧位姿作为世界坐标系，而vins有重力的对齐

### 跟踪线程的帧间紧耦合优化

imu预测相机位姿

固定地图点

两帧的滑窗

+ ![1569378509922](/home/slam/.config/Typora/typora-user-images/1569378509922.png)
+ a: 当有地图更新（新添加关键帧与地图点）
  + 固定上一关键帧，仅优化当前帧，视觉重投影误差与IMU预计分误差，
  + b;优化结束，marg掉关键帧与地图点
+ C：上一次窗口的先验，当前帧与当前帧观测到的地图点，优化变量为窗口内两帧的状态量
  + 优化结束，marg掉上一帧，先验信息
+ 重复上述相邻两非关键帧的优化，滑动窗口
+ 直至地图更新（更新了关键帧及地图点），进行步骤A
+ 留意先验信息的计算与VINs有何异同？？？
+ **没有优化地图点，地图点的优化在local mapping线程**

### Lacal mapping线程的优化

+ ![1569379913482](/home/slam/.config/Typora/typora-user-images/1569379913482.png)



+ 新插入一个关键帧，则进行优化
+ 优化局部地图中，共视程度最高的前N关键帧 local window
+ 地图点全部来自于loacl window，窗口的大小，影响实时性的表现
+ 在covisibility graph中，观察到局部地图点的，与local window相连的为fixed window，其状态量固定不动，值提供与局部地图点的观测值，用以优化局部地图点
+ 上图中，蓝色与绿色的方框提供视觉与imu测量误差，红框之外的节点为待优化变量
+ **以下来自原论文**

+ 原始ORB会在localmapping线程丢弃重复的关键帧，有imu时，关键帧的直接丢弃，限制连续关键帧之间的运动
+ 连续关键帧之间的时间差越大，imu提供的额信息越弱化
+ 如果两个连续关键帧，不在local window做BA优化，时间差超过0.5秒，则允许丢弃
+ 不允许任何两个连续关键帧的时间差超过3秒
+ 如果去掉全局BA中imu的限制，我们只需要限制local window中连续关键帧的时间差

### Loop closing

+ 6自由度的优化
+ 位姿图优化中，忽略imu的信息，不优化速度与bias，局部足够精确
+ 随后，全局BA，优化包括速度与bias在内的所有状态

## imu的初始化

+ 连续两关键帧的时间差要小，以降低imu噪声的累积
+ 陀螺仪的bias
+ 尺度与重力的预估，忽略加速度的bias
+ 加速度bias的估计，精确估计尺度与重力
+ 速度估计   
  +  通过预积分，计算最近关键帧的速度
+ 重定位后，bias的重新初始化
  + 仅有bias为未知，使用连续20帧估计bias
+ **考虑双目时，初始化与单目的不同**
+ 实际初始化的时间在10S左右，

###  实验结果

+ 在Euroc的V1_03_diffcult 上，测试失败，对单目，过于极端

+ 执行完后，进行一次全局fullBA，可以进一步提高精度

+ VIO优化的计算成本更高，相比于纯视觉，local window中做BA的帧更少，导致VIO 较纯视觉，精度稍有下降，

+ vio中，15次迭代在7秒以内，而纯视觉5次迭代少于1秒

+ 全局fullBA ，得到地图，地图复用，定位没有累积误差

+ 文献6,直接法的双目VIO 

+ 由于地图的复用，相比于文献6, 没有飘移

+ 文献6可以在V1_03_diffcult 上运行，

+ 直接法与特征法，应该优势互补

+ 双目相机会简化imu的初始化

+ 本文的主要缺点是imu的初始化 

  

## 原论文

+ 之前的工作，紧耦合的滤波器与非线性优化，缺少闭环与地图复用
+ 

# Msckf

+ 多状态约束，将多帧图像的相机位姿加入卡尔曼状态向量
+ 多帧图像的约束，最小二乘优化特征点的位置，特征点的位置约束状态向量
+ 视觉建立图像间的位姿约束，
+ 相机与imu已知的外参，用于状态增广
+ 无法全局优化，没有回环

## 视觉前端

+ 图像金字塔，LK光流
+ FAST特征检测，双目匹配去除outlier
+ LK光流跟踪，双目匹配，RANSAC
+ 特征点分类到图像网格中，按响应值，排序网格内的特征点
+ imu积分计算相对旋转，预测特征点的位置，对极几何约束，计算位姿
+ 双目之间的约束，验证光流跟踪的正确性，去除outlier
+ 



