### IMU 对相邻两帧的 pose 之间添加约束，而且对每一帧添加了状态量：陀螺仪和加速度计的 bias 和 speed（速度）

- reprojection error 从公式中可以看出可以优化系统的相机位姿，IMU 和相机的外参 *T**C**i**S*，和特征坐标 *k**W**l**j*。
- imu预积分优化迭代时，会根据状态量相对于 bias 的雅可比重新计算预积分值，当 bias 变化太大时，不能再用雅可比近似计算预积分值，这时会根据 IMU 测量值重新积分。沈老师的 VINS 系统也是这个思路
- 系统初始化时，会读入手工设定的 IMU 的 bias 参数（包含陀螺仪和加速度计），读入的 bias 作为先验，读入的 bias 和计算的 bias 相减作为 error。speed 没有手工设定，赋值为 0

## 视觉前端

- 图像均匀特征提取，描述子
- 由imu的测量值，初步预测相机位姿，用于特征描述子的提取？？
- 2d2d暴力匹配，三角化得特征点的位置，用于系统的初始化
- 特征点的匹配
  - 3d2d  由imu预测得到当前帧的位姿，来筛选3d可见特征点(之前一步得到的)，暴力匹配(描述子距离)（不同于ORB的guided matching），RANSAC误匹配的移除
- 关键帧的选择
  - 提取或匹配上的特征点数量不足，认为关键帧

## 边际化

- ![1569229749711](/home/slam/.config/Typora/typora-user-images/1569229749711.png)

  - 初始化时，前M帧设为关键帧，marg掉前几帧的速度项与bias

- ![1569229913144](/home/slam/.config/Typora/typora-user-images/1569229913144.png)

  - 最新帧为关键帧时，需要marg掉最老的非关键帧，包括去除相机与imu的观测
  - ![1569230060032](/home/slam/.config/Typora/typora-user-images/1569230060032.png)
  - 最新帧为非关键帧，需要marg掉最老的关键帧，同时，marg掉该最老关键帧所能观测到，而最新关键帧所不能观测到的地图点

  ![1569231567723](/home/slam/.config/Typora/typora-user-images/1569231567723.png)



## Okvis 原论文摘要

![1569240825875](/home/slam/.config/Typora/typora-user-images/1569240825875.png)

+ imu的测量引入帧间时间约束
+ 视觉重投影误差及其雅克比
  + 状态量为位姿，相机与imu的外参，路标点
+ imu的数学模型，测量误差方差的传递，时间戳的不对齐

## 框架

+ harris角点检测，brisk描述子提取，
  
  + 由于imu，沿重力方向提取的描述子，有更好的匹配结果
  + ![1569291396938](/home/slam/.config/Typora/typora-user-images/1569291396938.png)
+ 首先，3d2d的匹配，前后帧左右目的2d2d匹配，不同于ORB，**改进vins的双目匹配**

  + 挑战来自于强光的干扰，过曝光
+ 关键帧的选择

  + 投影或匹配上的地图点覆盖图像小于50%
  + 匹配上的关键点小于20%
+ 非线性优化中，边缘化的数学形式
+ 基于关键帧的边缘化

  + 被marg掉的关键帧，存入地图？？关键帧数据库？？？还是彻底丢弃？？（因为没有回环检测，不做全局优化，很可能丢弃）
+ 先验和变量的固定

  + 速度的初始标准偏差，加速度的与陀螺仪bias标准偏差设置，作为先验信息
  + 不固定绝对的偏航角，若固定，可能在优化中，引入误差，估计不准确
+ 信息矩阵的子块H，保证半正定性，矩阵分解H ∗ λ 1 λ 1 = UΛU T，将低于阈值的特征值设0
+ 在线的外参估计
+ 关键帧的数量与特征点的数量

### 结论

+ 采用较大数量的关键帧，没有显著优势，减少图像特征点的数目，性能也并未有显著下降
+ 